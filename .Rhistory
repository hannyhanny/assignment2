install.packages(fareway)
install.packages("fareway")
install.packages("faraway")
library(fareway)
library(faraway)
my_data <- data("teengamb")
my_data
my_data
my_data <- data("teengamb")
my_data
data("teengamb")
library(faraway)
my_data <- data("teengamb")
data("teengamb")
my_data
my_data <- data("teengamb")
data("teengamb")
my_data <- data("teengamb")
teengamb
my_data <-teengamb
typeof(my_data)
which(my_data$sex == 1)<-"female"
my_data[which(my_data$sex == 1)]<-"female"
my_data[which(my_data$sex == 0)]<-"male"
my_data
my_data
my_data <- data("teengamb")
my_data
my_data <-teengamb
my_data
which(my_data$sex == 0)
my_data[which(my_data$sex == 0)]
my_data$sex[which(my_data$sex == 0)]
my_data$sex[which(my_data$sex == 0)] <- "male"
my_data$sex[which(my_data$sex == 1)] <- "female"
my_data
factor(my_data$sex)
my_data
sumary(my_data)
summary(my_data)
plot(my_data$sex, my_data$status)
plot(my_data$status, my_data$income)
plot(my_data$status, my_data$gamble)
unique(my_data$verbal)
length(unique(my_data$verbal))
boxplot(my_data$verbal)
table(my_data$verbal)
install.packages("ggplot2")
install.packages("dplyr")
my_data_m <- my_data([which(my_data$sex == "male"),])
my_data_m <- my_data[which(my_data$sex == "male"),]
my_data_m
my_data_f <- my_data[which(my_data$sex == "female"),]
my_data_f
library(ggplot2)
library("ggplot2")
ggplot(my_data,aes("sex", colMeans(my_data)))
ggplot(my_data,aes("sex", colMeans(my_data$income)))
ggplot(my_data,aes("sex", mean(my_data$income)))
ggplot(my_data,aes("sex", my_data$income))
table(my_data_m)
apply(my_data_m)
summary(my_data_m)
summary(my_data_m)
summary(my_data_f)
average_f <- colMeans(my_data_f)
average_m <- colMeans(my_data_m[2,3,4,])
average_m <- colMeans(my_data_m-my_data_m$sex)
average_m <- colMeans(my_data[,-1])
my_data <-teengamb
average_m <- colMeans(my_data_m[,-1])
average_f <- colMeans(my_data_f[,-1])
average_data <-data.frame(average_m, average_f)
average_data
summary(my_data)
my_data$sex[which(my_data$sex == 0)] <- "male"
my_data$sex[which(my_data$sex == 1)] <- "female"
summary(my_data)
View(average_data)
plot(my_data$status, my_data$income)
res1 <- with(my_data, table(sex,status))
barplot(res1, legend = TRUE)
hist(my_data$status, col=rainbow(16),
main='status', xlab = '', ylab = 'frequency')
hist(my_data$status, col=cols,
main='status', xlab = '', ylab = 'frequency')
cols <- terrain.colors(10)
hist(my_data$status, col=cols,
main='status', xlab = '', ylab = 'frequency')
View(my_data)
hist(my_data$status, col=cols,
main='status', xlab = 'status score', ylab = 'frequency')
hist(my_data$income, col=cols,
main='income', xlab = 'income in pounds per week', ylab = 'frequency')
hist(my_data$verbal, col=cols,
main='verbal', xlab = 'verbal score', ylab = 'frequency')
hist(my_data$gamble, col=cols,
main='gamble', xlab = 'expenditure on gambling in pounds per year', ylab = 'frequency')
?plot
with(my_data, boxplot(my_data$status ~ my_data$sex))
with(teengamb, boxplot(teengamb$status ~ teengamb$sex, col=cols, ))
with(teengamb, boxplot(teengamb$status ~ teengamb$sex, col="pink", ))
with(my_data, boxplot(my_data$status ~ my_date$sex,
col="pink",
main="status",
xlab='sex',
ylab="status score"))
with(my_data, boxplot(my_data$status ~ my_data$sex,
col="pink",
main="status",
xlab='sex',
ylab="status score"))
with(my_data, boxplot(my_data$income ~ my_data$sex,
col="coral1",
main="income",
xlab='sex',
ylab="in pounds per week"))
with(my_data, boxplot(my_data$verbal ~ my_data$sex,
col="yellow2",
main="verbal",
xlab='sex',
ylab="verbal score"))
with(my_data, boxplot(my_data$gamble ~ my_data$sex,
col="green3",
main="gamble",
xlab='sex',
ylab="gambling in pounds per year"))
with(my_data, boxplot(my_data$gamble ~ my_data$sex,
col="green4",
main="gamble",
xlab='sex',
ylab="gambling in pounds per year"))
with(my_data, boxplot(my_data$status,
col="pink",
main="status",
xlab='sex',
ylab="status score"))
with(my_data, boxplot(my_data$verbal,
col="yellow2",
main="verbal",
xlab='sex',
ylab="verbal score"))
with(my_data, boxplot(my_data$gamble ,
col="green4",
main="gamble",
xlab='sex',
ylab="gambling in pounds per year"))
with(my_data, boxplot(my_data$status,
col="pink",
main="status",
xlab='',
ylab="status score"))
with(my_data, boxplot(my_data$income,
col="coral1",
main="income",
xlab='',
ylab="in pounds per week"))
with(my_data, boxplot(my_data$verbal,
col="yellow2",
main="verbal",
xlab='',
ylab="verbal score"))
with(my_data, boxplot(my_data$gamble ,
col="green4",
main="gamble",
xlab='',
ylab="gambling in pounds per year"))
with(my_data, boxplot(my_data$income,
col="coral1",
main="income",
xlab='',
ylab="in pounds per week"))
with(my_data, boxplot(my_data$status,
col="pink",
main="status",
xlab='',
ylab="status score"))
with(my_data, boxplot(my_data$verbal,
col="yellow2",
main="verbal",
xlab='',
ylab="verbal score"))
with(my_data, boxplot(my_data$gamble ,
col="green4",
main="gamble",
xlab='',
ylab="gambling in pounds per year"))
with(my_data, boxplot(my_data$verbal,
col="yellow2",
main="verbal",
xlab='',
ylab="verbal score"))
plot(my_data$status, my_data$income)
plot(my_data$status, my_data$gamble)
unique(my_data$verbal)
length(unique(my_data$verbal))
rank(unique(my_data$verbal))
summary(my_data_m)
summary(my_data_f)
plot(my_data$status, my_data$income)
plot(my_data$status, my_data$income, xlab = "status", ylab = "income")
plot(my_data$status, my_data$income, xlab = "status", ylab = "income", col = "purple4")
plot(my_data$status, my_data$income, xlab = "status", ylab = "income", col = "blue4")
plot(my_data$income, my_data$gamble, xlab = "income",
ylab = "gamble", col = "purple4")
plot(my_data$income, my_data$verbal, xlab = "income",
ylab = "verbel", col = "red3")
plot(my_data$verbal, my_data$income, xlab = "verbal",
ylab = "income", col = "pink3")
unique(my_data$verbal)
length(unique(my_data$verbal))
getwd()
da <- read.csv("cars.csv")
seted("/Users/dalaohuhan/Documents/GitHub/assignment2")
setwd("/Users/dalaohuhan/Documents/GitHub/assignment2")
cars_data <- read.csv("cars.csv")
View(cars_data)
setwd("/Users/dalaohuhan")
data("uswages")
View(uswages)
?lm
lm1 <- lm(wage ~ educ + exper, data = uswages)
lm1
summary(lm1)
residuals(lm1)
which.max[residuals(lm1)]
which.max(residuals(lm1))
which.max(a)
a< - c(1,2,9,5,6,4,3,5,8)
a <- c(1,2,9,5,6,4,3,5,8)
which.max(a)
which.max(residuals(lm1))
mean(residuals(lm1))
median(residuals(lm1))
which(uswages$exper < 0)
m <- which(uswages$exper < 0)
data_wage <- uswages[-m]
m <- which(uswages$exper < 0)
data_wage <- uswages[-m,]
lm1 <- lm(wage ~ educ + exper, data = data_wage)
summary(lm1)
which.max(residuals(lm1))
mean(residuals(lm1))
median(residuals(lm1))
fitted(lm1)
cor(fitted(lm1), residuals(lm1))
cor(residuals(lm1),fitted(lm1))
plot(residuals(lm1),fitted(lm1))
plot(residuals(lm1),fitted(lm1),
xlab = "residuals", ylab = "fitted", col="pink")
plot(residuals(lm1),fitted(lm1),
xlab = "residuals", ylab = "fitted values", col="pink")
plot(fitted(lm1), residuals(lm1),
ylab = "residuals", xlab = "fitted values", col="pink")
x <- 1:20
y <- x+rnorm(20)
plot(fitted(lm1), residuals(lm1),
ylab = "residuals", xlab = "fitted values", col="pink",
main = "residuals against fitted values")
lm2 <- lm(y ~ poly(x, 2, raw = TRUE))
lm2
summary(lm2)
plot(x,y)
lm(y ∼ x + I(x2))
lm(y ∼ x + I(x^2))
lm(y ~ x + I(x^2))
xtxi %*% t(x) %*% y
xtx <- t(x) %*% x
xtxi <- solve(xtx)
xtxi %*% t(x) %*% y
lm(y ~ x + I(x^2) + I(x^3))
X <- cbind(1, x, x^2)
beta_direct <- solve(t(X) %*% X) %*% t(X) %*% y
beta_direct
X <- cbind(1, x, x^2, x^3)
beta_direct <- solve(t(X) %*% X) %*% t(X) %*% y
beta_direct
lm(y ~ x + I(x^2) + I(x^3) + I(x^4))
X <- cbind(1, x, x^2, x^3, x^4)
beta_direct <- solve(t(X) %*% X) %*% t(X) %*% y
beta_direct
X <- cbind(1, x, x^2, x^3, x^4, x^5)
beta_direct <- solve(t(X) %*% X) %*% t(X) %*% y
beta_direct
lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5))
X <- cbind(1, x, x^2, x^3, x^4, x^5, x^6)
beta_direct <- solve(t(X) %*% X) %*% t(X) %*% y
lm(y ~ x + I(x^2) + I(x^3) + I(x^4) + I(x^5) + I(x^6))
lm2 <- lm(y ~ x + I(x^2))
summary(lm2)
lm(y ~ x)
summary(lm(y ~ x))
summary(lm(y ~ x + I(x^2) + I(x^3)))
summary(lm(y ~ x + I(x^2) + I(x^3) + I(x^4)))
summary(lm(y ~ x + I(x^2) + I(x^3) + I(x^4) +I(x^5)))
summary(lm(y ~ x + I(x^2) + I(x^3) + I(x^4) +I(x^5) + I(x^6)))
plot(x,y)
lines(y,fitted(lm(y ~ x), col= "pink3"))
plot(x,y)
lines(y,fitted(lm(y ~ x)), col= "pink3")
plot(x,y)
f <- lm(y ~ x)
lines(y,fitted(f), col= "pink3")
plot(x,y)
f <- lm(y ~ x)
lines(x,fitted(f), col= "pink3")
plot(x,y)
lines(x,fitted(lm(y ~ x)), col= "pink3")
plot(x,y)
lines(x,fitted(lm(y ~ x)), col= "pink3",
main = "y = b0 + b1x")
plot(x,y)
lines(x,fitted(lm(y ~ x)), col= "pink3",
main = "y = b0 + b1x")
plot(x,y, main = "y = b0 + b1x")
lines(x,fitted(lm(y ~ x)), col= "pink3")
plot(x,y, main = "y = b0 + b1x + b2x^2")
lines(x,fitted(lm(y ~ x + I(x^2))), col= "yellow3")
plot(x,y, main = "y = b0 + b1x + b2x^2 + b3x^3 + b4x^4 + b5x^5 + b6x^6")
lines(x,fitted(lm(y ~ x + I(x^2)+I(x^3) + I(x^4) +I(x^5) + I(x^6))),
col= "blue3")
cars <- read.csv("cars.csv")
setwd("/Users/dalaohuhan/Documents/GitHub/assignment2")
cars <- read.csv("cars.csv")
m <- which(uswages$exper < 0)
data_wage <- uswages[-m,]
lm1 <- lm(wage ~ educ + exper, data = data_wage)
mean(residuals(lm1))
median(residuals(lm1))
cor(residuals(lm1),fitted(lm1))
View(cars)
names(cars) <- c("height",
"length",
"width",
"driveline",
"engine_type",
"hybrid",
"gears",
"trans",
"city_mpg",
"fuel_type",
"hw_mpg",
"id_class",
"id",
"id_make",
"model_year",
"id_year",
"horsepower",
"torque")
View(cars)
cars_data <- read.csv("cars.csv")
names(cars_data) <- c("height",
"length",
"width",
"driveline",
"engine_type",
"hybrid",
"gears",
"trans",
"city_mpg",
"fuel_type",
"hw_mpg",
"id_class",
"id",
"id_make",
"model_year",
"id_year",
"horsepower",
"torque")
cars <- cars_data[which(cars_data$fuel_type = "Gasoline")]
cars <- cars_data[which(cars_data$fuel_type == "Gasoline"),]
play_dice <- function(n) {
r = -2
for (i in 1:n) {
d = sample(1:6, 1, replace = T)
if d = 1 or 3 or 5:
sample(1:6, 1, replace = T)
play_dice <- function(n) {
r = -2
for (i in 1:n) {
d = sample(1:6, 1, replace = T)
if d = 1 | 3 | 5:
play_dice <- function(n) {
r = -2
for (i in 1:n) {
d = sample(1:6, 1, replace = T)
if d == 1 | 3 | 5:
d = sample(1:6, 1, replace = T)
d == 2
play_dice <- function(n) {
r = -2
for (i in 1:n) {
d = sample(1:6, 1, replace = T)
if (d == 1 | 3 | 5) {
r = r+0
}
if (d == 2) {
r = r+2
}
if (d == 4) {
r = r+4
}
if (d == 6) {
r = r+6
}
}
return(r)
}
play_dice(10)
play_dice(8)
play_dice <- function(n) {
r = -2
for (i in 1:n) {
d = sample(1:6, 1, replace = T)
if (d == 1 | 3 | 5) {
r = r+0
}
if (d == 2) {
r = r+2
}
if (d == 4) {
r = r+4
}
if (d == 6) {
r = r+6
}
}
return(r)
}
play_dice <- function(n) {
r = -2
for (i in 1:n) {
d = sample(1:6, 1, replace = T)
if (d == 1 | 3 | 5) {
r = r+0
}
if (d == 2) {
r = r+2
}
if (d == 4) {
r = r+4
}
if (d == 6) {
r = r+6
}
}
return(r)
}
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(8)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
play_dice(1)
data_wage <- uswages[-(m,)]
data("uswages")
m <- which(uswages$exper < 0)
data_wage <- uswages[-m,]
lm1 <- lm(wage ~ educ + exper, data = data_wage)
cor(residuals(lm1),fitted(lm1))
data_wage <- uswages[which(uswages$exper < 0)]
data_wage <- uswages[which(uswages$exper >= 0)]
View(X)
data_wage <- which(uswages$exper >= 0)
lm1 <- lm(wage ~ educ + exper, data = data_wage)
data_wage <- uswages[which(uswages$exper >= 0)]
data_wage <- uswages[which(uswages$exper >= 0),]
lm1 <- lm(wage ~ educ + exper, data = data_wage)
cor(residuals(lm1),fitted(lm1))
data_wage <- uswages[which(uswages$exper >= 0),]
